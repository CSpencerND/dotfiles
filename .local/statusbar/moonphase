#!/usr/bin/env bash

# Shows the current moon phase.

moonfile="$XDG_CACHE_HOME/moonphase"

# [ "$(stat -c %y "$moonfile" 2>/dev/null | cut -d' ' -f1)" = "$(date '+%Y-%m-%d')" ] ||
x=0
until [ "$x" -ge 3 ]; do
  curl -sf "wttr.in/?format=%m" > "$moonfile" && break
  x=$((x+1))
  sleep 1
done

icon="$(cat "$moonfile")"

case "$icon" in
	ğŸŒ‘) name="New" ;;
	ğŸŒ’) name="Waxing Crescent" ;;
	ğŸŒ“) name="First Quarter" ;;
	ğŸŒ”) name="Waxing Gibbous" ;;
	ğŸŒ•) name="Full" ;;
	ğŸŒ–) name="Waning Gibbous" ;;
	ğŸŒ—) name="Last Quarter" ;;
	ğŸŒ˜) name="Waning Crescent" ;;
	*) exit 1 ;;
esac

# echo "${icon-?}"

# case $BLOCK_BUTTON in
# 	3) notify-send "ğŸŒœ Moon phase module" "Displays current moon phase.
# - ğŸŒ‘: New
# - ğŸŒ’: Waxing Crescent
# - ğŸŒ“: First Quarter
# - ğŸŒ”: Waxing Gibbous
# - ğŸŒ•: Full
# - ğŸŒ–: Waning Gibbous
# - ğŸŒ—: Last Quarter
# - ğŸŒ˜: Waning Crescent" ;;
# 	6) "$TERMINAL" -e "$EDITOR" "$0" ;;
# esac
