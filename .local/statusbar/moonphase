#!/usr/bin/env bash

x=0
until [ "$x" -ge 3 ]; do
  curl -sf "wttr.in/?format=%m" > ~/.cache/moonphase && break
  x=$((x+1))
  sleep 1
done

icon="$(cat ~/.cache/moonphase)"

case "$icon" in
	ğŸŒ‘) name="New" ;;
	ğŸŒ’) name="Waxing Crescent" ;;
	ğŸŒ“) name="First Quarter" ;;
	ğŸŒ”) name="Waxing Gibbous" ;;
	ğŸŒ•) name="Full" ;;
	ğŸŒ–) name="Waning Gibbous" ;;
	ğŸŒ—) name="Last Quarter" ;;
	ğŸŒ˜) name="Waning Crescent" ;;
	*) exit 1 ;;
esac

case "$name" in
    "New"             ) icon="î  " ;;
    "Waxing Crescent" ) icon="î—  " ;;
    "First Quarter"   ) icon="îœ  " ;;
    "Waxing Gibbous"  ) icon="î  " ;;
    "Full"            ) icon="î›  " ;;
    "Waning Gibbous"  ) icon="î  " ;;
    "Last Quarter"    ) icon="î  " ;;
    "Waning Crescent" ) icon="î  " ;;
    # *) exit 1 ;;
esac

echo "${icon-?}" > ~/.cache/moonphase




# case "$icon" in
# 	î ) name="New" ;;
# 	î— ) name="Waxing Crescent" ;;
# 	îœ ) name="First Quarter" ;;
# 	î ) name="Waxing Gibbous" ;;
# 	î› ) name="Full" ;;
# 	î ) name="Waning Gibbous" ;;
# 	î ) name="Last Quarter" ;;
# 	î ) name="Waning Crescent" ;;
# 	*) exit 1 ;;
# esac
    
